---
title: "Poročilo pri predmetu Analiza podatkov s programom R"
author: "Marcel Špehonja"
output:
  html_document: default
  pdf_document:
    includes:
      in_header: lib/styles.sty
    latex_engine: xelatex
runtime: shiny
---

<style type="text/css">
h1.title {
  font-size: 26px;
  color: Dark Grey;
}
h4.author{
  color:Grey;
  margin-bottom: 40px;
}
h1.naslov{
  font-size: 50px;
  margin-bottom: 20px;
}
</style>

```{r setup, echo=FALSE, results='hide', message=FALSE, warning=FALSE}
# Če želimo nastaviti pisave v PDF-ju, odkomentiramo
# in sledimo navodilom v programu.
#source("fontconfig.r", encoding="UTF-8")

# Uvoz vseh potrebnih knjižnic
source("lib/libraries.r", encoding="UTF-8")
```

```{r rstudio, echo=FALSE, results='asis'}
# Izris povezave do RStudia na Binderju
source("lib/rstudio.r", encoding="UTF-8")
```

<center> <h1 class="naslov">Rodnost po državah sveta</h1> </center>


# Izbira teme

V projektu bom analiziral rodnost, to je pogostost rojevanja živorojenih otrok v kaki populaciji v določenem obdobju, izražena kot število živorojenih otrok na tisoč prebivalcev. Obravnaval bom letne podatke za posamezno državo in sicer od leta 2000 do 2018. Ugotavljal bom, kako je rodnost posameznih držav odvisna od različnih dejavnikov, kot so stopnja ekonomske razvitosti države, izobraženost, pričakovana življenjska doba, število splavov. Cilj naloge je ugotoviti ali imajo bolj razvite države res nižjo rodnost, kot države v razvoju, in kateri so najbolj pomembni dejavniki ki vplivajo na rodnost.

<center>
![](slike/birth_rate.jpg){width=50%}
</center>

***
# Obdelava, uvoz in čiščenje podatkov

```{r uvoz, echo=FALSE, message=FALSE, warning=FALSE}
source("uvoz/uvoz.r", encoding="UTF-8")
```

Uvozili smo podatke o državah sveta v obliki CSV s spletne strani WorldBank. Podatke sem uredil v tri razpredelnice v obliki *tidy data*.

&nbsp;

1. `Drzave sveta` - podatki o državah sveta
  - `Drzava` - spremenljivka: ime države (neurejen faktor),
  - `Leto` - spremenljivka: Podatki Podatki o letu (števila od 2000 do 2018),
  - `GDP PPP ($)` - meritev: BDP po kupni moči (PPP) v ameriških dolarjih (število),
  - `Prebivalci` - meritev: število prebivalcev v posamezni državi (število),
  - `Rodnost` - meritev: Število novorojenih otrok na 1000 ljudi (število),
  - `Pricakovana zivlj. doba` - meritev: Pričakovana življenjska doba ob rojstvu (število),
  - `Umrljivost novorojenckov` - meritev: Število smrti novorojenčkov na 1000 rojstev (število),
  - `Procent vpisa v srednjo solo` - meritev: Procent vpisa otrok v srednjo šolo (število),
  - `Stevilo splavov` - meritev: Število splavov v enem letu (število).
  
&nbsp;
  
2. `Celine` - podatki po celinah
  - `Celina` - spremenljivka: ime celine (neurejen faktor),
  - `Leto` - spremenljivka: Podatki o letu (števila od 2000 do 2018),
  - `Povprecje BDP` - meritev: Povprečen BDP po kupni moči (PPP) v ameriških dolarjih (število),
  - `Povprecje rodnost` - meritev: Povprečno število novorojenih otrok na 1000 ljudi (število).
  
&nbsp;
  
3. `Religije` - podatki po religijah
  - `Religija` - spremenljivka: ime religije (neurejen faktor),
  - `Leto` - spremenljivka: Podatki o letu (števila od 2000 do 2018),
  - `Povprecje BDP` - meritev: Povprečen BDP po kupni moči (PPP) v ameriških dolarjih (število),
  - `Povprecje rodnost` - meritev: Povprečno število novorojenih otrok na 1000 ljudi (število).


***
# Analiza in vizualizacija podatkov

```{r vizualizacija, echo=FALSE, message=FALSE, warning=FALSE, results='hide', fig.show = 'hide'}
source("vizualizacija/vizualizacija.r", encoding="UTF-8")
```

Najprej sem si izbral osem držav iz različnih delov sveta in 

&nbsp;

```{r graf3, echo=FALSE, message=FALSE, fig.align='center', warning = FALSE}
print(graf3)
```

&nbsp;

&nbsp;

```{r shiny, echo=FALSE, warning = FALSE}
shinyAppDir("shiny", options=list(width="100%", height=800))
```




<!-- Spodnji graf prikazuje porazdelitev števila naselij v občinah. -->

<!-- ```{r histogram, echo=FALSE, message=FALSE, fig.align='center', fig.cap='Histogram števila naselij v občinah'} -->
<!-- ggplot(obcine, aes(x=naselja)) + geom_histogram() + -->
<!--   ggtitle("Pogostost števila naselij") + xlab("Število naselij") + ylab("Število občin") -->
<!-- ``` -->

<!-- *** -->

<!-- # Analiza in vizualizacija podatkov -->

<!-- ```{r vizualizacija, echo=FALSE, message=FALSE, warning=FALSE, results='hide'} -->
<!-- source("vizualizacija/vizualizacija.r", encoding="UTF-8") -->
<!-- ``` -->

<!-- Spodnji zemljevid prikazuje povprečno velikost družine za vsako občino. -->

<!-- ```{r zemljevid, echo=FALSE, fig.align='center', fig.cap='Zemljevid povprečnega števila otrok v družini'} -->
<!-- ggplot() + geom_polygon(data=left_join(zemljevid, povprecja, by=c("OB_UIME"="obcina")), -->
<!--                         aes(x=long, y=lat, group=group, fill=povprecje)) + -->
<!--   ggtitle("Povprečno število otrok v družini") + xlab("") + ylab("") + -->
<!--   guides(fill=guide_colorbar(title="Povprečje")) -->
<!-- ``` -->

<!-- *** -->

<!-- # Napredna analiza podatkov -->

<!-- ```{r analiza, echo=FALSE, message=FALSE} -->
<!-- source("analiza/analiza.r", encoding="UTF-8") -->
<!-- ``` -->

<!-- Spodnji graf prikazuje povezavo med številom naselij in površino občine. -->

<!-- ```{r graf, echo=FALSE, fig.align='center', fig.cap='Povezava med številom naselij in površino občine'} -->
<!-- ggplot(inner_join(obcine, data.frame(obcina=names(skupine), -->
<!--                                      skupina=factor(skupine)), by="obcina") -->
<!-- , aes(x=povrsina, y=naselja, color=skupina, size=prebivalci/1000)) + geom_point() + -->
<!--   ggtitle("Število naselij glede na površino občine") + -->
<!--   xlab(expression("Površina (km"^2 * ")")) + ylab("Št. naselij") + -->
<!--   guides(color=guide_legend(title="Skupina"), -->
<!--          size=guide_legend(title="Prebivalci (* 1000)")) -->
<!-- ``` -->
